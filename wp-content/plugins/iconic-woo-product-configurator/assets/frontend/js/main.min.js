window.addEventListener("load",function(){window.iconic_wpc_layer_updated_timeout=0;var s=jQuery,l={$image_wrap:null,has_swatches:0<s("[data-attribute-name]").length,has_configurator:0<s(".iconic-pc-images").length,has_woothumbs:0<s(".iconic-woothumbs-images").length,$variations_form:s(".product .variations_form"),variation_selects:".variations select",default_images:{},loaded_images:{},load_ids:{global:0},on_load(){l.set_elements(),l.setup_default_images(),l.setup_image_switcher(),l.setup_swatches(),l.setup_inventory(),l.setup_woothumbs(),l.setup_variation_swatches_photos(),l.setup_variation_swatches_for_woocommerce(),l.has_swatches&&l.reset_layers(),l.$variations_form.find("select").trigger("change")},setup_default_images(){l.$image_wrap.find("div").each(function(e,a){var a=s(a),t=a.attr("class").match(/iconic-pc-image--([^\s]+)/);t&&(t=t[0],l.default_images["."+t]=a.html())})},sanitise_str(e,a){return a=void 0===a||a,e&&""!==e?(e=(e=a?"jckpc-"+e:e).replace("/","").replace(/ +/g,"-").replace(/[^a-zA-Z0-9-_]/g,"").replace(/(-)\1+/g,"-").replace(/(_)\1+/g,"_")).toLowerCase():""},get_layer_id(e){var a=".iconic-pc-image--";return 0===e.indexOf(a)?e:a+(e=e.replace("attribute_",""))},get_default_image(e){return l.default_images[e]},clear_layer(e){var a=(e=0===e.indexOf(".")?e:l.get_layer_id(e)).replace(".iconic-pc-image--jckpc-",""),a=s('[data-iconic_pc_layer_id="'+a+'"]');void 0!==a&&(a=""===a.val()?l.get_default_image(e):"",s(e).html(a))},load_image_layer(e,a){l.$image_wrap.data("iconic_pc_product_id");a=a.replace("attribute_","");var a=l.get_layer_id(a),t=l.get_load_id(a),e=(void 0===l.loaded_images[a]&&(l.loaded_images[a]={}),e.replace(/%/g,""));void 0!==l.loaded_images[a][e]?l.update_image_layer(a,l.loaded_images[a][e],t):(l.set_loading(!0),l.load_json_images())},load_json_images(){var e,a=l.$image_wrap.data("iconic_pc_product_id"),r=[],t=l.get_selected_attributes();for(e in t)r[e.replace("attribute_","jckpc-")]=t[e];var o,c=l.get_conditional_images(r),_=JSON.parse(s(".iconic-pc-layers-"+a).html());if(_)for(var n in r){let e=l.get_layer_id(n),a="",t=l.get_load_id(e),i=r[n].replace(/%/g,"");""===(a=void 0!==c[n]&&void 0!==(o=c[n][i])?o.image_html:a)&&(o=_[n][i],a=void 0===o?"":o.image_html),l.update_image_layer(e,a,t)}else l.set_loading(!1)},get_conditional_images(a){var t=[],e=l.$image_wrap.data("iconic_pc_product_id"),e=s(".iconic-pc-layers-conditionals-"+e);if(!(e.length<=0)){var i,r=JSON.parse(e.html());for(i in r)for(var o in r[i]){let e=0;for(var c in r[i][o].rules){var c=r[i][o].rules[c],_=a[c.attribute];_&&("is_equal_to"===c.condition?_===c.value&&e++:"is_not_equal_to"===c.condition&&_!==c.value&&e++)}if(e===r[i][o].rules.length)for(var n in r[i][o].value){n=r[i][o].value[n];void 0===t[i]&&(t[i]=[]),t[i][n.attribute.replace("jckpc-","")]=n.value}}}return t},set_loading(e){"clear"===e?l.load_ids.global=0:e?l.load_ids.global++:0<l.load_ids.global&&l.load_ids.global--},update_image_layer(e,a,t){var i=l.get_load_id(e);l.set_loading(!1),t===i&&(a?"1"===jckpc.preload_layers?l.preload_img_and_modify_dom(e,a):s(e).html(a):l.clear_layer(e),s(document.body).trigger("iconic_pc_image_layer_updated"))},preload_img_and_modify_dom(a,t){var e=(new DOMParser).parseFromString(t,"text/html").querySelector("img"),i=document.createElement("img");i.onload=function(){var e;s(a).html(t),l.has_woothumbs||(e=s(".woocommerce-product-gallery__image--jckpc").first()).length&&(e.trigger("zoom.destroy"),e.css("pointer-events","none"),l.update_large_image())},e.sizes&&(i.sizes=e.sizes),e.srcset&&(i.srcset=e.srcset),i.src=e.src},generate_image_url(e){let a=jckpc.ajaxurl;return a=(a=(a+=a.indexOf("?")<0?"?":"&")+"action=iconic_pc_generate_image"+("&prodid="+e))+("&"+l.get_selected_attributes("string"))},get_selected_attributes(e){e=e||"array";let r={},a=s(".variations").filter(":first,:not(.iconic-wlv-variations)").find("select[name^='attribute_']"),o=[];return a.each(function(e,a){var t=s(a).data("attribute_name");if(-1===o.indexOf(t)){a=s(a),a=l.get_select_field_data(a);if(""===a.value){var i=l.get_layer_id(a.attribute),i=s(i);if(!i.length)return;i=i.data("iconic_pc_default_layer");a.value=i||""}r[a.attribute_stripped]=a.value,o.push(t)}}),"string"===e?s.param(r,!0):r},setup_image_switcher(){if(l.has_configurator){s(document).on("change",l.variation_selects,function(){l.update_attribute_layers(s(this))});let e;s(document.body).on("iconic_pc_image_layer_updated",function(){clearTimeout(e),e=setTimeout(function(){l.update_large_image()},100)})}},increment_load_id(e){s(".variations").filter(":first").find("select").each(function(e,a){a=s(a),a=l.get_select_field_data(a),a=l.get_layer_id(a.attribute);l.get_load_id(a)||(l.load_ids[a]=0),l.load_ids[a]++})},get_load_id(e){e=l.get_layer_id(e);return void 0!==l.load_ids[e]&&l.load_ids[e]},setup_swatches(){l.has_swatches&&l.has_configurator&&s(".swatch-anchor").on("click",function(){var e=s(this),a=e.closest("form"),a=JSON.parse(a.attr("data-variations_map")),t=e.closest(".select"),e=e.closest(".select-option"),t=t.attr("data-attribute-name"),i=e.attr("data-value"),r=l.sanitise_str(t),a=a[t][i];e.hasClass("selected")?l.clear_layer(r):l.load_image_layer(a,r),s(document.body).trigger("iconic_pc_image_layer_updated")})},get_swatch_value(e,a){return JSON.parse(l.$variations_form.attr("data-variations_map"))[e][a]},reset_layers(){s("#variations_clear").on("click",function(){s.each(l.default_images,function(e,a){l.$image_wrap.find(e).html(a)})})},setup_inventory(){l.$variations_form.on("woocommerce_update_variation_values",function(){"undefined"!=typeof jckpc_inventory&&s.each(jckpc_inventory,function(a,e){s.each(e,function(i,e){let r=s('.variations_form[data-product_id="'+a+'"] select[data-attribute_name="attribute_'+i+'"]');0<r.length&&s.each(e,function(e,a){var t=e.replace("jckpc-",""),t=r.find('option[value|="'+t+'"]'),e=s('.va-picker[data-attribute="'+i+'"][data-term="'+e+'"]');""!==a&&parseInt(a)<=0&&(t.attr("disabled","disabled").removeClass("enabled"),0<e.length)&&e.hide()})})})}),l.has_swatches&&l.has_configurator&&"undefined"!=typeof jckpc_inventory&&void 0!==l.$variations_form.attr("data-variations_map")&&s("[data-attribute-name]").each(function(){let e=s(this),r=e.attr("data-attribute-name"),a=null;e.is("select")?(a=e.find("option")).each(function(e,a){var t,i=s(a).val();""!==i&&(i=l.get_swatch_value(r,i),t=r.replace("attribute_",""),i=i.replace("jckpc-",""),""!==(t=jckpc_inventory[t][i]))&&parseInt(t)<=0&&s(a).remove()}):(a=e.find(".select-option")).each(function(e,a){var t,i=s(a).attr("data-value");""!==i&&(i=l.get_swatch_value(r,i),t=r.replace("attribute_",""),i=i.replace("jckpc-",""),""!==(t=jckpc_inventory[t][i]))&&parseInt(t)<=0&&s(a).remove()})})},set_elements(){l.$image_wrap=s(".iconic-pc-image-wrap")},setup_woothumbs(){l.has_woothumbs&&(s(document.body).on("iconic_pc_image_layer_updated",function(){let a=s(".iconic-woothumbs-images.slick-initialized");if(!(a.length<=0)){let e=a.find(".iconic-pc-images").closest(".slick-slide").data("slick-index")||0;clearTimeout(window.iconic_wpc_layer_updated_timeout),window.iconic_wpc_layer_updated_timeout=setTimeout(function(){a.slick("slickGoTo",e)},50)}}),s(".iconic-woothumbs-all-images-wrap").on("iconic_woothumbs_images_loaded",function(e,a){a=a.variations_form.find(".variations").filter(":first").find("select").first();a.length<=0||l.update_attribute_layers(a)}))},update_attribute_layers(e){s(document.body).trigger("iconic_pc_image_before_layer_updated");e=l.get_select_field_data(e);l.increment_load_id(e.attribute),e.value?l.load_image_layer(e.value,e.attribute):l.clear_layer(e.attribute),jQuery(".iconic-pc-image img").removeClass("wp-post-image"),setTimeout(function(){s(document.body).trigger("iconic_pc_image_layer_updated")},100)},update_large_image(){let e=parseInt(s(".iconic-pc-image-wrap").data("iconic_pc_product_id")),a=l.generate_image_url(e),t=s(".woocommerce-product-gallery__image--jckpc"),i=s(".woocommerce-product-gallery__image--jckpc .zoomImg");s(".iconic-pc-image--background img").attr("data-large_image",a).attr("data-src",a),!l.has_woothumbs&&"1"===jckpc.preload_layers&&0<t.length?(t.trigger("woocommerce_gallery_init_zoom"),setTimeout(function(){t.first().css("pointer-events","auto")},2500)):0<i.length&&i.attr("src",a)},get_select_field_data(e){var a,t,i,r={attribute_stripped:null,attribute:null,value:null};return l.has_swatches&&void 0!==l.$variations_form.attr("data-variations_map")?(a=JSON.parse(l.$variations_form.attr("data-variations_map")),t=e.attr("data-attribute-name"),i=e.val(),r.attribute=l.sanitise_str(t),r.attribute_stripped=r.attribute.replace("jckpc-",""),r.value=a[t][i]):(r.attribute=l.sanitise_str(e.attr("name")),r.attribute_stripped=r.attribute.replace("jckpc-",""),r.value=e.val()),r},setup_variation_swatches_photos(){var e;jQuery(".variations_form.swatches").length&&(l.variation_selects+=", "+(e=".variations_form.swatches .variation_form_section input:hidden"),l.has_swatches=!1,s(e).each(function(){let e=s(this);e.attr("data-attribute-name",e.attr("name")),e.parent().find(".select-option a").click(function(){setTimeout(function(){e.trigger("change")},200)})}))},setup_variation_swatches_for_woocommerce(){s(document).on("wvs-item-updated","li.variable-item",function(){s(this).closest(".variations_form").hasClass("wvs-loaded")||s(this).closest(".woo-variation-items-wrapper").find("select").trigger("change")})}};let e=s(".cart.bundle_form"),a=s(".cart.bundle_data"),t=".product .variations_form";0<a.length?(e.hasClass("initialized")?(l.$variations_form=s(t),l.on_load()):a.on("woocommerce-product-bundle-initialized",function(e,a){l.$variations_form=s(t),l.on_load()}),l.$variations_form.find("select").trigger("change")):l.on_load()});